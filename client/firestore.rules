rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /contactMessages/{docId} {
      allow create: if request.resource.data.keys().hasOnly([
        'firstName',
        'lastName',
        'email',
        'message',
        'company',
        'role',
        'website',
        'tools',
        'urgency',
        'source',
        'status',
        'pageUrl',
        'createdAt'
      ])
      && request.resource.data.firstName is string
      && request.resource.data.lastName is string
      && request.resource.data.email is string
      && request.resource.data.message is string
      && request.resource.data.source is string
      && request.resource.data.status is string
      && request.resource.data.pageUrl is string
      && request.resource.data.createdAt is timestamp
      && request.resource.data.firstName.size() >= 1
      && request.resource.data.lastName.size() >= 1
      && request.resource.data.email.size() >= 3
      && request.resource.data.message.size() >= 10;

      allow read, update, delete: if false;
    }
  }
}
